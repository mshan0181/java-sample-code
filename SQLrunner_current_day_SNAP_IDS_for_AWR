pipeline {
    agent any
    stages {
        stage('SNAPID_for_AWR_report') {
            steps {
                 step([$class: 'SQLPlusRunnerBuilder',credentialsId:'shandb-priv-id', instance:'client_access',scriptType:'file', script: 'AWR_SQL_temp.sql',scriptContent: ''])
            }
        }
        stage('triggerChildJob') {
            steps {
                build job: "SQL_runner_AWR_report_in_Oracle", wait: true
            }
        }
    }
}


stage('SQL_script_runner_AWR_report') {    
    bat 'echo define DB_ID=%dbid% > AWR_SQL_temp.sql' 
    bat 'echo define INSTANCE_NO=%inst_num% >> AWR_SQL_temp.sql'
    bat 'echo define BEGIN_ID=%bid% >> AWR_SQL_temp.sql'
    bat 'echo define END_ID=%eid% >> AWR_SQL_temp.sql'
    bat 'type AWR_report.sql >> AWR_SQL_temp.sql'
    step([$class: 'SQLPlusRunnerBuilder',credentialsId:'shandb-priv-id', instance:'client_access',scriptType:'file', script: 'AWR_SQL_temp.sql',scriptContent: ''])   
       }   
